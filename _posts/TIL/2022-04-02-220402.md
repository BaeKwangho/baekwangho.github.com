---
title: "220402"
categories:
  - til
---

백엔드 서버가 안정된 상황을 갖도록 하기 위해서는, 연결된 서버 등에 의해 시간이 지연되면 안된다는 것을 깨달았다. 서비스에서는 nas 서버를 이미지 서버로 사용하여 자주 연결을 갖곤 하는데, 꺼져 있을 경우에 대한 대비책이 하나도 없다는 것을 깨달았다.

![](/assets/imgs/node/2022/0402_(1).PNG)
*30초를 기다리셔야 합니다, 손님*

서버가 꺼져 있거나 요청 시간이 길 경우, 각 상황에 맞는 에러 처리를 해야하는 것이 정석일테지만, 현재 구현된 상태로는 이를 효율적으로 구성하기엔 어려움이 있을 것 같아 서버 핑 테스트를 미들웨어로 진행한 후 작업을 분기하는 것으로 하였다.

![](/assets/imgs/node/2022/0402_(2).PNG)
*특별한 건 없고, 각 서버에 날린 핑이 안되면 특정 에러코드와 함께 에러를 생성해 반환한다*

추후엔 이런 방법을 통해서 서비스별 분기가 이루어질 수 있도록도 구현 가능할테다.. (예를들어, 이미지 서버가 되지 않아도 해당 접근을 제외한 모든 작업 가능하게끔도..)